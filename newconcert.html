<!DOCTYPE html>
<html lang="en">

<head>
    <title>Add New Headliner Show</title>
    <link href="newconcertstyle.css" type="text/css" rel="stylesheet" />
</head>

<body>
    <form id="newheadliner">
        <h1>Add Headliner Show</h1>
        <fieldset>
            <label>Headliner:</label>
            <input type="text" name="headliner">
        </fieldset>
        <fieldset>
            <label>City:</label>
            <input type="text" name="city">
        </fieldset>
        <fieldset>
            <label>Venue:</label>
            <input type="text" name="venue">
        </fieldset>
        <fieldset>
            <label>Date:</label>
            <input type="date" name="date" value="2018-08-02" min="1900-01-01" max="2020-12-31">
        </fieldset>

        <fieldset>
            <input type="submit" value="Add opening band" id="submitbutton">
            <div id="bandcontainer"></div>
            <input type="reset" value="Remove last band" id="resetbutton">
            <script>
                let container = document.getElementById('bandcontainer');
                let button = document.getElementById('submitbutton');
                let resetButton = document.getElementById('resetbutton');
                let i = 0;
                button.addEventListener('click', function () {
                    event.preventDefault();
                    i++;
                    let newForm = document.createElement('input');
                    newForm.setAttribute('type', 'text');
                    newForm.setAttribute('name', `openingBand${[i]}`);
                    newForm.setAttribute('placeholder', `Opening band ${[i]}`);
                    newForm.setAttribute('id', `${[i]}`);
                    newForm.classList = null;
                    newForm.classList.add('newBandForm');
                    container.appendChild(newForm);
                    // console.log(newForm.name);
                });

                resetButton.addEventListener('click', function () {
                    event.preventDefault();
                    container.removeChild(container.lastChild);
                })
            </script>
        </fieldset>

        <fieldset>
            <input type="submit" value="Create" id="submit">

        </fieldset>
    </form>
    <br>
    <div id="fill"></div>
    <script>
        // let subButton = document.getElementById('submit')
        let form = document.querySelector('form');
        let divList = document.getElementById('fill');

        form.onsubmit = function () {
            event.preventDefault();
            let formElements = document.getElementById("newheadliner").elements;
            let postData = {};
            for (let i = 0; i < formElements.length; i++) {
                if (formElements[i].type != "submit")//we dont want to include the submit-buttom
                    postData[formElements[i].name] = formElements[i].value;
            }
            let headliner = postData.headliner;
            let city = postData.city;
            let date = postData.date;
            let venue = postData.venue;
            let bands = container.children[0].value;

            function numberToDate(date) {

                console.log(date);

                let string = date.toString();

                console.log(string);

                let year = string.slice(0, 4);

                let month = string.slice(5, 7);

                let day = string.slice(8, 10);

                console.log(year);
                console.log(month);
                console.log(day);

                let writtenMonth;
                let writtenDay;

                if (month == 01) {
                    writtenMonth = "January";
                }

                else if (month == 02) {
                    writtenMonth = "February";
                }

                else if (month == 03) {
                    writtenMonth = "March";
                }

                else if (month == 04) {
                    writtenMonth = "April";
                }

                else if (month == 05) {
                    writtenMonth = "May";
                }

                else if (month == 06) {
                    writtenMonth = "June";
                }

                else if (month == 07) {
                    writtenMonth = "July";
                }

                else if (month == 08) {
                    writtenMonth = "August";
                }

                else if (month == 09) {
                    writtenMonth = "September";
                }

                else if (month == 10) {
                    writtenMonth = "October";
                }

                else if (month == 11) {
                    writtenMonth = "November";
                }

                else if (month == 12) {
                    writtenMonth = "December";
                }



                if (day.charAt(0) == 1) {
                    writtenDay = `${day}th`;
                }

                else if (day.charAt(1) == 1) {
                    writtenDay = `${day}st`;
                }

                else if (day.charAt(1) == 2) {
                    writtenDay = `${day}nd`;
                }

                else if (day.charAt(1) == 3) {
                    writtenDay = `${day}rd`;
                }

                else {
                    writtenDay = `${day}th`;
                }

                let finalDate = `${writtenMonth} ${writtenDay}, ${year}`;
                return finalDate;

            }

            let writtenDate = numberToDate(date);

            if (!headliner) {
                console.log("You must enter a headliner!");
            }

            if (!bands) {
                let concertText = `${headliner} - ${writtenDate} @ ${venue}, ${city}`;
                divList.textContent = concertText;
            }
            else {
                let concertText = `${headliner} w/ ${bands} - ${writtenDate} @ ${venue}, ${city}`;
                divList.textContent = concertText;
            }

        }


    </script>
</body>

</html>