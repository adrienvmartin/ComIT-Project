extends ./layout.pug

block content
    h1 Main Listing
    br
    ul.bandlisting
        -let yearArray = [];
        each val in documents
            -let showNumber = documents.indexOf(val) + 1;
            -let headliner = val.headliner;
            -let openers = val.openers;
            -let city = val.city;
            -let venue = val.venue;
            -let date = val.date;
            -let writtenDate = val.writtendate;
            -let showType = val.showtype;
            -let festivalName = val.festival;
            -let year = val.date.slice(0, 4);
            -let showid = val.showid;
            -console.log(year);

            -let splitOpeners = openers.split(", ");
            -let firstTwoOpeners = splitOpeners[0] + ', ' + splitOpeners[1] + `, & ${splitOpeners.length - 2} others`;

            -if (showType == "headlinergig" && openers.length == 0)
                b #{year}
                li.show #{showNumber} - 
                    a(href='event').showlist
                        b #{val.headliner} 
                        |  - #{writtenDate} @ #{venue}, #{city}

            -else if (showType == "headlinergig" && openers.length > 0)
                li.show #{showNumber} - 
                    a(href='event').showlist
                        b #{val.headliner} 
                        | w/ #{openers} - #{writtenDate} @ #{venue}, #{city}
            -else if (showType == "festival")
                li.show #{showNumber} - 
                    a(href='event')
                        b.festival #{festivalName}
                        |  - #{val.headliner} w/ #{firstTwoOpeners} - #{writtenDate} @ #{venue}, #{city}
            br